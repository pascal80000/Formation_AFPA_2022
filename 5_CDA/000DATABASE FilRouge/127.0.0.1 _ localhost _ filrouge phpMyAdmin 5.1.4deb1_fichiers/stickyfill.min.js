'use strict';let seppuku=!1;const isWindowDefined=typeof window!="undefined";if(!isWindowDefined||!window.getComputedStyle)seppuku=!0;else{const e=document.createElement("div");['',"-webkit-","-moz-","-ms-"].some(t=>{try{e.style.position=t+"sticky"}catch(e){}return e.style.position!=''})&&(seppuku=!0)}let isInitialized=!1;const shadowRootExists=typeof ShadowRoot!="undefined",scroll={top:null,left:null},stickies=[];function extend(n,e){for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t])}function parseNumeric(e){return parseFloat(e)||0}function getDocOffsetTop(e){let t=0;for(;e;)t+=e.offsetTop,e=e.offsetParent;return t}class Sticky{constructor(e){if(!(e instanceof HTMLElement))throw new Error("First argument must be HTMLElement");if(stickies.some(t=>t._node===e))throw new Error("Stickyfill is already applied to this node");this._node=e,this._stickyMode=null,this._active=!1,stickies.push(this),this.refresh()}refresh(){if(seppuku||this._removed)return;this._active&&this._deactivate();const e=this._node,t=getComputedStyle(e),n={position:t.position,top:t.top,display:t.display,marginTop:t.marginTop,marginBottom:t.marginBottom,marginLeft:t.marginLeft,marginRight:t.marginRight,cssFloat:t.cssFloat};if(isNaN(parseFloat(n.top))||n.display=="table-cell"||n.display=="none")return;this._active=!0;const u=e.style.position;(t.position=="sticky"||t.position=="-webkit-sticky")&&(e.style.position="static");const r=e.parentNode,o=shadowRootExists&&r instanceof ShadowRoot?r.host:r,s=e.getBoundingClientRect(),c=o.getBoundingClientRect(),i=getComputedStyle(o);this._parent={node:o,styles:{position:o.style.position},offsetHeight:o.offsetHeight},this._offsetToWindow={left:s.left,right:document.documentElement.clientWidth-s.right},this._offsetToParent={top:s.top-c.top-parseNumeric(i.borderTopWidth),left:s.left-c.left-parseNumeric(i.borderLeftWidth),right:-s.right+c.right-parseNumeric(i.borderRightWidth)},this._styles={position:u,top:e.style.top,bottom:e.style.bottom,left:e.style.left,right:e.style.right,width:e.style.width,marginTop:e.style.marginTop,marginLeft:e.style.marginLeft,marginRight:e.style.marginRight};const l=parseNumeric(n.top);this._limits={start:s.top+window.pageYOffset-l,end:c.top+window.pageYOffset+o.offsetHeight-parseNumeric(i.borderBottomWidth)-e.offsetHeight-l-parseNumeric(n.marginBottom)};const d=i.position;d!="absolute"&&d!="relative"&&(o.style.position="relative"),this._recalcPosition();const a=this._clone={};a.node=document.createElement("div"),extend(a.node.style,{width:s.right-s.left+"px",height:s.bottom-s.top+"px",marginTop:n.marginTop,marginBottom:n.marginBottom,marginLeft:n.marginLeft,marginRight:n.marginRight,cssFloat:n.cssFloat,padding:0,border:0,borderSpacing:0,fontSize:"1em",position:"static"}),r.insertBefore(a.node,e),a.docOffsetTop=getDocOffsetTop(a.node)}_recalcPosition(){if(!this._active||this._removed)return;const e=scroll.top<=this._limits.start?"start":scroll.top>=this._limits.end?"end":"middle";if(this._stickyMode==e)return;switch(e){case"start":extend(this._node.style,{position:"absolute",left:this._offsetToParent.left+"px",right:this._offsetToParent.right+"px",top:this._offsetToParent.top+"px",bottom:"auto",width:"auto",marginLeft:0,marginRight:0,marginTop:0});break;case"middle":extend(this._node.style,{position:"fixed",left:this._offsetToWindow.left+"px",right:this._offsetToWindow.right+"px",top:this._styles.top,bottom:"auto",width:"auto",marginLeft:0,marginRight:0,marginTop:0});break;case"end":extend(this._node.style,{position:"absolute",left:this._offsetToParent.left+"px",right:this._offsetToParent.right+"px",top:"auto",bottom:0,width:"auto",marginLeft:0,marginRight:0});break}this._stickyMode=e}_fastCheck(){if(!this._active||this._removed)return;(Math.abs(getDocOffsetTop(this._clone.node)-this._clone.docOffsetTop)>1||Math.abs(this._parent.node.offsetHeight-this._parent.offsetHeight)>1)&&this.refresh()}_deactivate(){if(!this._active||this._removed)return;this._clone.node.parentNode.removeChild(this._clone.node),delete this._clone,extend(this._node.style,this._styles),delete this._styles,stickies.some(e=>e!==this&&e._parent&&e._parent.node===this._parent.node)||extend(this._parent.node.style,this._parent.styles),delete this._parent,this._stickyMode=null,this._active=!1,delete this._offsetToWindow,delete this._offsetToParent,delete this._limits}remove(){this._deactivate(),stickies.some((e,t)=>{if(e._node===this._node)return stickies.splice(t,1),!0}),this._removed=!0}}const Stickyfill={stickies,Sticky,forceSticky(){seppuku=!1,init(),this.refreshAll()},addOne(e){if(!(e instanceof HTMLElement))if(e.length&&e[0])e=e[0];else return;for(var t=0;t<stickies.length;t++)if(stickies[t]._node===e)return stickies[t];return new Sticky(e)},add(e){if(e instanceof HTMLElement&&(e=[e]),!e.length)return;const t=[];for(let n=0;n<e.length;n++){const s=e[n];if(!(s instanceof HTMLElement)){t.push(void 0);continue}if(stickies.some(e=>{if(e._node===s)return t.push(e),!0}))continue;t.push(new Sticky(s))}return t},refreshAll(){stickies.forEach(e=>e.refresh())},removeOne(e){if(!(e instanceof HTMLElement))if(e.length&&e[0])e=e[0];else return;stickies.some(t=>{if(t._node===e)return t.remove(),!0})},remove(e){if(e instanceof HTMLElement&&(e=[e]),!e.length)return;for(let t=0;t<e.length;t++){const n=e[t];stickies.some(e=>{if(e._node===n)return e.remove(),!0})}},removeAll(){for(;stickies.length;)stickies[0].remove()}};function init(){if(isInitialized)return;isInitialized=!0;function s(){window.pageXOffset!=scroll.left?(scroll.top=window.pageYOffset,scroll.left=window.pageXOffset,Stickyfill.refreshAll()):window.pageYOffset!=scroll.top&&(scroll.top=window.pageYOffset,scroll.left=window.pageXOffset,stickies.forEach(e=>e._recalcPosition()))}s(),window.addEventListener("scroll",s),window.addEventListener("resize",Stickyfill.refreshAll),window.addEventListener("orientationchange",Stickyfill.refreshAll);let o;function n(){o=setInterval(function(){stickies.forEach(e=>e._fastCheck())},500)}function i(){clearInterval(o)}let e,t;"hidden"in document?(e="hidden",t="visibilitychange"):"webkitHidden"in document&&(e="webkitHidden",t="webkitvisibilitychange"),t?(document[e]||n(),document.addEventListener(t,()=>{document[e]?i():n()})):n()}seppuku||init(),typeof module!="undefined"&&module.exports?module.exports=Stickyfill:isWindowDefined&&(window.Stickyfill=Stickyfill)